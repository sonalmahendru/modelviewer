<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <script src="https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js" defer></script>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"></script>  
    <script src="js/script.js"></script>     
    </head>
    <body onload="selectAnimationToPlay()">
        <model-viewer autoplay id="modelviewer" src="assets/Breakdance.gltf" ios-src="assets/sample-drum.reality" alt="A 3D model of an astronaut" auto-rotate ar camera-controls></model-viewer>
        
        <button slot="ar-button" id="ar-button" onclick="loadAR()">View in AR</button>

        <div class="slider">
            <div class="slides">
                <button class="slide" onclick="switchSrc(this)">
                    Play random animation
                </button>
            </div>
        </div>
        <!--<a href="intent://arvr.google.com/scene-viewer/1.0?file=https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Avocado/glTF/Avocado.gltf#Intent;scheme=https;package=com.google.android.googlequicksearchbox;action=android.intent.action.VIEW;S.browser_fallback_url=https://developers.google.com/ar;end;">Avocado</a>-->
    </body>
    <script>

        var assets = ['Breakdance','ChickenDance','clapAndSpin','dougie','footShuffle','Gangnam','hipHop','Macarena','Moonwalk','selfie']

        function selectAnimationToPlay(){
            if(assets.length>1){
                let i = Math.floor(Math.random()*10);
                console.log(assets[i]);
                var asset = assets[i];
                assets.splice(i,1);
                return asset;
            }
            return assests[0];         
        }

        function playRandomAnimation(){
            var anim = selectAnimationToPlay();
            let asset = "assets/"+anim+".gltf";
            document.querySelector("model-viewer").src=asset;
        }

        function loadAR(){
            var viewer = document.getElementById("modelviewer");
            viewer.activateAR()
        }
        
    </script>

<script type="module">
    const modelViewer = document.querySelector("model-viewer");
  
    window.switchSrc = (element) => {
      var name = selectAnimationToPlay();
      const base = "assets/" + name;
      modelViewer.src = base + '.gltf';
      modelViewer.iosSrc = "assets/sample-drum.reality";
      //modelViewer.poster = base + '.png';
      const slides = document.querySelectorAll(".slide");
      slides.forEach((element) => {element.classList.remove("selected");});
      element.classList.add("selected");
    };
  
    document.querySelector(".slider").addEventListener('beforexrselect', (ev) => {
      // Keep slider interactions from affecting the XR scene.
      ev.preventDefault();
    });
  </script>
</html>